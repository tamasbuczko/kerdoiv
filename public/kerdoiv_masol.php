<?php//kérdőív másolásaif (($_REQUEST[masol]) AND ( $_SESSION[qa_user_id])) {    //Bemeneti adat int-e    if (filter_input(INPUT_GET, "kerdoiv", FILTER_VALIDATE_INT)) {        /////////////////////////        //        //          Kérdőív másolása        //                $kerdoiveredeti = mysql_fetch_row(mysql_query("SELECT * FROM `kerdoivek` WHERE `sorszam`='" . $_GET[kerdoiv] . "'"));        $ma = date("Y-m-d");                $ujkerdoivbeszuras = "INSERT INTO  `kerdoivek` VALUES (NULL ";        //-------------------Ezzel a módszerrel a dátum változó a régiét kapja ami lehet hiba!        for ($index = 1; $index < count($kerdoiveredeti); $index++) {            if ($index == 2) {                $kerdoiveredeti[$index] = $kerdoiveredeti[$index] . " másolat";            }            if ($index == 1) {                $kerdoiveredeti[$index] = $kerdoiveredeti[$index] . "_masolat";            }            if ($index == 8) {                $kerdoiveredeti[$index] ="0";            }            $ujkerdoivbeszuras = $ujkerdoivbeszuras . ", '" . $kerdoiveredeti[$index] . "'";        }        $ujkerdoivbeszuras = $ujkerdoivbeszuras . ")";        //beillesztük az új kérdőívet        mysql_query($ujkerdoivbeszuras);        //echo $ujkerdoivbeszuras."<br />";        //lekérjük az új kérdőív ID-jét ami a $ujkerdoivid[id] változóban megtalálható lesz        $ujkerdoivid = mysql_fetch_assoc(mysql_query("SELECT `sorszam` as id FROM `kerdoivek` ORDER BY `sorszam` DESC"));        /////////////////////////////////6        //        //        //        //          Kérdések másolása        //kérdések másolása        $kerdesekeredetik = mysql_query("SELECT * FROM `kerdesek` WHERE `kerdoiv_sorszam`='" . $_GET[kerdoiv] . "'");        while ($kerdesekeredeti = mysql_fetch_row($kerdesekeredetik)) {            $ujkerdesbeszuras = "INSERT INTO  `kerdesek` VALUES (NULL, '" . $ujkerdoivid[id] . "' ";            for ($index = 2; $index < count($kerdesekeredeti); $index++) {                $ujkerdesbeszuras = $ujkerdesbeszuras . ", '" . $kerdesekeredeti[$index] . "'";            }            $ujkerdesbeszuras = $ujkerdesbeszuras . ")";            //beillesztük az új kérdőívet            //echo $ujkerdesbeszuras."<br />";            mysql_query($ujkerdesbeszuras);            //a kérdés ID-je            $ujkerdesid = mysql_fetch_assoc(mysql_query("SELECT `sorszam` as id FROM `kerdesek` ORDER BY `sorszam` DESC"));           //////////////////////////            ///            //            //              Válaszok másolása            //feltöltjük a válaszadási lehetőségeket is, ez az utolsó szint            $valaszokeredetik = mysql_query("SELECT * FROM `valaszok` WHERE `kerdoiv_sorszam`='" . $_GET[kerdoiv] . "' AND `kerdes_valasz`='" . $kerdesekeredeti[0] . "'");           // echo "SELECT * FROM `valaszok` WHERE `kerdoiv_sorszam`='" . $_GET[kerdoiv] . "' AND `kerdes_valasz`='" . $kerdesekeredeti[0] . "'";            while ($valaszokeredeti = mysql_fetch_row($valaszokeredetik)) {                $ujvalaszbeszuras = "INSERT INTO  `valaszok` VALUES (NULL, '" . $ujkerdoivid[id] . "', '" . $ujkerdesid[id] . "' ";                for ($index = 3; $index < count($valaszokeredeti); $index++) {                    $ujvalaszbeszuras = $ujvalaszbeszuras . ", '" . $valaszokeredeti[$index] . "'";                }                $ujvalaszbeszuras = $ujvalaszbeszuras . ")";                //beillesztük az új kérdőívet                //echo $ujvalaszbeszuras."<br />";                mysql_query($ujvalaszbeszuras);            }        }         header("Location: index.php?p=kerdoiv&mod=1&kerdoiv=".$ujkerdoivid[id]);    } else {        //logolas hibás próbálkozás vagy törési kisérletre    }}